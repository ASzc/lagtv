<a name='post-<%= post.id %>'></a>
<div id='post_<%= post.id %>' class='post <%= cycle('odd', 'even') -%>'>

  <div class='user'>
    <div class='username'>
      <%= link_to_if Forem.user_profile_links, post.user, [main_app, post.user] %>
    </div>
    <div class='role'>
      <%= post.user.role.titleize %>
    </div>
    <div class='icon'>
      <%= image_tag post.user.avatar_url(60) %>
    </div>
  </div>

  <div class='contents'>
    <a name='#post-<%= post.id %>'></a>
    <time datetime="<%= post.created_at.to_s(:db) -%>">
      <%= "#{time_ago_in_words(post.created_at)} #{t("ago")}" %>
      <% if post.reply_to %>
        <%= link_to "in reply to #{post.reply_to.user}", post_path(post.reply_to, params[:page]) %>
      <% end %>  
    </time>
    
    <%= forem_format(post.text) %>

    <% if post.user.show_signature && post.user.signature.present? && !current_user.hide_others_signatures %>
      <div class="signature"><%= forem_format(post.user.signature) %></div>
    <% end %>

    

    <% if post.pending_review? %>
      <div class='moderation'>
        <%= t(".pending_review") %>
        <% if forem_admin_or_moderator?(post.topic.forum) %>
          <% if local_assigns[:mass_moderation] %>
            <%= render "forem/posts/moderation_tools", :post => post %>
          <% else %>
            <%= form_tag forum_moderate_posts_path(post.topic.forum), :method => :put do %>
              <%= render "forem/posts/moderation_tools", :post => post %>
            <% end %>
          <% end %>
        <% end %>
      </div>
    <% end %>

    <ul class='actions'>
      <% if forem_user %>
        <% if can?(:reply, post.topic) %>
          <% if post.topic.can_be_replied_to? %>
            <li><%= link_to t('reply', :scope => 'forem.topic'), new_topic_post_path(post.topic, :reply_to_id => post.id) %></li>
          <% end %>
          <% if post.topic.can_be_replied_to? %>
            <li><%= link_to t('quote', :scope => 'forem.topic'), new_topic_post_path(post.topic, :reply_to_id => post.id, :quote => true) %></li>
          <% end %>
        <% end %>
        <% if post.owner_or_admin?(forem_user) %>
          <% if can?(:edit_post, post.topic.forum) %>
            <li><%= link_to t('edit', :scope => 'forem.post'), edit_topic_post_path(post.topic, post) %></li>
          <% end %>
          <li><%= link_to t('delete', :scope => 'forem.topic'), topic_post_path(post.topic, post), :method => :delete, :confirm => t("are_you_sure") %></li>
        <% end %>
      <% end %>
    </ul>

  </div>
</div>
